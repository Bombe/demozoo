{% extends "base.html" %}

{% load demoscene_tags %}

{% block html_title %}{{ title }} - Demozoo{% endblock %}

{% block extra_head %}
	<script src="/static/js/maintenance.js"></script>
{% endblock %}

{% block body_class %}maintenance_report{% endblock %}

{% block base_main %}
	<h2>{{ title }}:</h2>
	<div id="main_column">
		<div class="panel report" data-report-name="{{ report_name }}">
			<form action="{% url maintenance_fix_release_dates %}" method="post">
				{% csrf_token %}
				<table width="100%">
					<col width="30%" />
					<col width="10%" />
					<col width="20%" />
					<col width="30%" />
					<tr>
						<th>Production</th>
						<th>Release date</th>
						<th>By</th>
						<th>Suggested date</th>
					</tr>
					{% for prod in productions %}
						<tr class="excludable" data-record-id="{{ prod.id }}">
							<td class="{{ prod.supertype }}"><a href="{{ prod.get_absolute_url }}">{{ prod.title }}</a></td>
							<td>{{ prod.release_date }}</td>
							<td>{% byline prod %}</td>
							<td>
								{% if prod.suggested_release_date %}
									<input type="checkbox" name="production_id" id="production_id_{{ prod.id }}" value="{{ prod.id }}" />
									<input type="hidden" name="production_{{ prod.id }}_release_date_date" value="{{ prod.suggested_release_date.date|date:"Y-m-d" }}" />
									<input type="hidden" name="production_{{ prod.id }}_release_date_precision" value="{{ prod.suggested_release_date.precision }}" />
								{% endif %}
								<label for="production_id_{{ prod.id }}">{{ prod.suggested_release_date }}</label>
								<em>({{ prod.release_detail }})</em>
							</td>
						</tr>
					{% endfor %}
					
					<tr>
						<td></td>
						<td></td>
						<td></td>
						<td>
							<input type="hidden" name="return_to" value="{{ return_to }}" />
							<input type="submit" value="Update selected records" />
						</td>
					</tr>
				</table>
			</form>
		</div>
	</div>
{% endblock %}